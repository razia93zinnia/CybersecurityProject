{
  "success": true,
  "status_code": 200,
  "json": {
    "data": {
      "mutexes_created": [
        "\\Sessions\\1\\BaseNamedObjects\\DBWinMutex"
      ],
      "tags": [
        "IDLE",
        "CHECKS_USER_INPUT"
      ],
      "verdict_confidence": 1,
      "processes_tree": [
        {
          "process_id": "2272",
          "name": "%windir%\\System32\\svchost.exe -k WerSvcGroup"
        },
        {
          "process_id": "2968",
          "name": "%windir%\\system32\\wbem\\wmiprvse.exe"
        },
        {
          "process_id": "2664",
          "name": "%SANDBOX_DLL_LOADER_X86% %SAMPLEPATH% %WORKDIR% 483"
        },
        {
          "process_id": "2928",
          "name": "wmiadap.exe /F /T /R"
        },
        {
          "process_id": "6040",
          "name": "\"C:\\Windows\\System32\\rundll32.exe\" \"C:\\Users\\<USER>\\Desktop\\readme.dll\",#1"
        },
        {
          "process_id": "1856",
          "name": "C:\\Windows\\System32\\loaddll32.exe loaddll32.exe \"C:\\Users\\user\\Desktop\\attachment.dll\"",
          "children": [
            {
              "process_id": "6868",
              "name": "C:\\Windows\\SysWOW64\\cmd.exe cmd.exe /C rundll32.exe \"C:\\Users\\user\\Desktop\\attachment.dll\",#1",
              "children": [
                {
                  "process_id": "1716",
                  "name": "C:\\Windows\\SysWOW64\\rundll32.exe rundll32.exe  \"C:\\Users\\user\\Desktop\\attachment.dll\",#1"
                }
              ]
            },
            {
              "process_id": "3484",
              "name": "C:\\Windows\\SysWOW64\\rundll32.exe rundll32.exe C:\\Users\\user\\Desktop\\attachment.dll,CombinatPackage"
            },
            {
              "process_id": "7188",
              "name": "C:\\Windows\\SysWOW64\\rundll32.exe rundll32.exe \"C:\\Users\\user\\Desktop\\attachment.dll\",CombinatPackage"
            }
          ]
        }
      ],
      "processes_terminated": [
        "%windir%\\System32\\svchost.exe -k WerSvcGroup",
        "wmiadap.exe /F /T /R"
      ],
      "mbc": [
        {
          "id": "C0063",
          "objective": "File System",
          "behavior": "Move File",
          "refs": [
            {
              "ref": "#signature_matches",
              "value": "1"
            }
          ]
        },
        {
          "id": "C0047",
          "objective": "File System",
          "behavior": "Delete File",
          "refs": [
            {
              "ref": "#signature_matches",
              "value": "2"
            }
          ]
        },
        {
          "id": "E1083",
          "objective": "Discovery",
          "behavior": "File and Directory Discovery",
          "refs": [
            {
              "ref": "#signature_matches",
              "value": "4"
            }
          ]
        },
        {
          "id": "C0052",
          "objective": "File System",
          "behavior": "Writes File",
          "refs": [
            {
              "ref": "#signature_matches",
              "value": "7"
            }
          ]
        },
        {
          "id": "OC0006"
        },
        {
          "id": "C0005.001"
        },
        {
          "id": "C0002"
        }
      ],
      "files_opened": [
        "C:\\Users\\<USER>\\Desktop\\readme.dll.manifest",
        "C:\\Users\\<USER>\\Desktop\\readme.dll",
        "C:\\Users\\<USER>\\Desktop\\readme.dll.123.Manifest",
        "C:\\Users\\<USER>\\Desktop\\readme.dll.124.Manifest",
        "C:\\Users\\<USER>\\Desktop\\readme.dll.2.Manifest",
        "C:\\Users\\<USER>\\Desktop\\MZ\\x90",
        "C:\\Program Files (x86)\\Common Files\\Oracle\\Java\\javapath\\",
        "C:\\Users\\user\\Desktop\\MZ ",
        "C:\\Users\\user\\Desktop\\attachment.dll",
        "C:\\Users\\user\\Desktop\\attachment.dll.123.Manifest",
        "C:\\Users\\user\\Desktop\\attachment.dll.124.Manifest",
        "C:\\Users\\user\\Desktop\\attachment.dll.2.Manifest",
        "C:\\Windows\\AppPatch\\sysmain.sdb",
        "C:\\Windows\\Globalization\\Sorting\\sortdefault.nls",
        "C:\\Windows\\SysWOW64\\",
        "C:\\Windows\\SysWOW64\\AcLayers.DLL",
        "C:\\Windows\\SysWOW64\\CRYPTBASE.dll",
        "C:\\Windows\\SysWOW64\\FLTLIB.DLL",
        "C:\\Windows\\SysWOW64\\GDI32.dll",
        "C:\\Windows\\SysWOW64\\IMM32.DLL",
        "C:\\Windows\\SysWOW64\\IPHLPAPI.DLL",
        "C:\\Windows\\SysWOW64\\KERNEL32.DLL",
        "C:\\Windows\\SysWOW64\\KERNELBASE.dll",
        "C:\\Windows\\SysWOW64\\MPR.dll",
        "C:\\Windows\\SysWOW64\\MSCTF.dll",
        "C:\\Windows\\SysWOW64\\OLEAUT32.dll",
        "C:\\Windows\\SysWOW64\\PROPSYS.dll",
        "C:\\Windows\\SysWOW64\\RPCRT4.dll",
        "C:\\Windows\\SysWOW64\\SETUPAPI.dll",
        "C:\\Windows\\SysWOW64\\SHELL32.dll",
        "C:\\Windows\\SysWOW64\\SspiCli.dll",
        "C:\\Windows\\SysWOW64\\USER32.dll",
        "C:\\Windows\\SysWOW64\\WINSPOOL.DRV",
        "C:\\Windows\\SysWOW64\\advapi32.dll",
        "C:\\Windows\\SysWOW64\\apphelp.dll",
        "C:\\Windows\\SysWOW64\\bcrypt.dll",
        "C:\\Windows\\SysWOW64\\bcryptPrimitives.dll",
        "C:\\Windows\\SysWOW64\\cfgmgr32.dll",
        "C:\\Windows\\SysWOW64\\combase.dll",
        "C:\\Windows\\SysWOW64\\dwmapi.dll",
        "C:\\Windows\\SysWOW64\\en-US\\rundll32.exe.mui",
        "C:\\Windows\\SysWOW64\\gdi32full.dll",
        "C:\\Windows\\SysWOW64\\imagehlp.dll",
        "C:\\Windows\\SysWOW64\\kernel.appcore.dll",
        "C:\\Windows\\SysWOW64\\loaddll32.exe",
        "C:\\Windows\\SysWOW64\\msvcp_win.dll",
        "C:\\Windows\\SysWOW64\\msvcrt.dll",
        "C:\\Windows\\SysWOW64\\ntdll.dll",
        "C:\\Windows\\SysWOW64\\ole32.dll",
        "C:\\Windows\\SysWOW64\\powrprof.dll",
        "C:\\Windows\\SysWOW64\\profapi.dll",
        "C:\\Windows\\SysWOW64\\rundll32.exe",
        "C:\\Windows\\SysWOW64\\sechost.dll",
        "C:\\Windows\\SysWOW64\\sfc.dll",
        "C:\\Windows\\SysWOW64\\sfc_os.DLL",
        "C:\\Windows\\SysWOW64\\shcore.dll",
        "C:\\Windows\\SysWOW64\\shlwapi.dll",
        "C:\\Windows\\SysWOW64\\ucrtbase.dll",
        "C:\\Windows\\SysWOW64\\uxtheme.dll",
        "C:\\Windows\\SysWOW64\\win32u.dll",
        "C:\\Windows\\SysWOW64\\windows.storage.dll",
        "\\Device\\KsecDD",
        "C:\\Users\\user\\Desktop\\init.dll",
        "C:\\Users\\user\\Desktop\\init.dll.123.Manifest",
        "C:\\Users\\user\\Desktop\\init.dll.124.Manifest",
        "C:\\Users\\user\\Desktop\\init.dll.2.Manifest",
        "C:\\Windows\\SYSTEM32\\ole32.dll",
        "C:\\Windows\\System32\\en-US\\user32.dll.mui",
        "C:\\Windows\\WinSxS\\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.17134.1304_none_d3fbe61b7c93d9f0",
        "C:\\Windows\\WinSxS\\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.17134.1304_none_d3fbe61b7c93d9f0\\comctl32.DLL",
        "C:\\Windows\\system32\\IMM32.DLL",
        "C:\\Windows\\system32\\conhost.exe",
        "C:\\Windows\\system32\\dwmapi.dll",
        "C:\\Windows\\system32\\en-US\\conhost.exe.mui",
        "C:\\Windows\\system32\\loaddll32.exe",
        "C:\\Windows\\system32\\uxtheme.dll",
        "C:\\Windows\\system32\\uxtheme.dll.Config",
        "\\Device\\ConDrv\\Server",
        "\\Device\\ConDrv\\\\Reference"
      ],
      "processes_created": [
        "\"C:\\Windows\\System32\\rundll32.exe\" \"C:\\Users\\<USER>\\Desktop\\readme.dll\",#1"
      ],
      "mitre_attack_techniques": [
        {
          "id": "T1083",
          "severity": "IMPACT_SEVERITY_INFO",
          "signature_description": "get common file path",
          "refs": [
            {
              "ref": "#signature_matches",
              "value": "4"
            }
          ]
        },
        {
          "id": "T1614",
          "severity": "IMPACT_SEVERITY_INFO",
          "signature_description": "get geographical location",
          "refs": [
            {
              "ref": "#signature_matches",
              "value": "5"
            }
          ]
        },
        {
          "id": "T1129",
          "severity": "IMPACT_SEVERITY_INFO",
          "signature_description": "access PEB ldr_data",
          "refs": [
            {
              "ref": "#signature_matches",
              "value": "6"
            }
          ]
        },
        {
          "id": "T1129",
          "severity": "IMPACT_SEVERITY_INFO",
          "signature_description": "get ntdll base address",
          "refs": [
            {
              "ref": "#signature_matches",
              "value": "8"
            }
          ]
        },
        {
          "id": "T1055",
          "severity": "IMPACT_SEVERITY_INFO",
          "signature_description": "Creates a process in suspended mode (likely to inject code)"
        },
        {
          "id": "T1055",
          "severity": "IMPACT_SEVERITY_INFO",
          "signature_description": "Spawns processes"
        },
        {
          "id": "T1218.011",
          "severity": "IMPACT_SEVERITY_INFO",
          "signature_description": "Runs a DLL by calling functions"
        },
        {
          "id": "T1082",
          "severity": "IMPACT_SEVERITY_INFO",
          "signature_description": "Reads software policies"
        },
        {
          "id": "T1056",
          "severity": "IMPACT_SEVERITY_INFO",
          "signature_description": "Creates a DirectInput object (often for capturing keystrokes)"
        }
      ],
      "verdicts": [
        "UNKNOWN_VERDICT",
        "CLEAN"
      ],
      "files_written": [
        "\\Device\\ConDrv\\\\Connect"
      ],
      "registry_keys_opened": [
        "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize\\DisableMetaFiles",
        "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize",
        "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize\\DisableUmpdBufferSizeCheck",
        "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize\\AppsUseLightTheme",
        "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize",
        "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion",
        "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Layers",
        "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders",
        "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\AppModel\\Lookaside\\Packages",
        "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\DllNXOptions",
        "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\cmd.exe",
        "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\loaddll32.exe",
        "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\rundll32.exe",
        "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\OLE",
        "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\OLEAUT",
        "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Policies\\Microsoft\\WindowsStore",
        "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\MUI\\UILanguages\\en-US",
        "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Nls\\CustomLocale",
        "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager",
        "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Segment Heap",
        "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Policies\\Microsoft\\Cryptography\\Configuration",
        "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Ole",
        "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Ole\\FeatureDevelopmentProperties",
        "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Disable8And16BitMitigation",
        "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Wow64\\x86",
        "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Wow64\\x86\\xtajit",
        "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\LanguageOverlay\\OverlayPackages\\en-US",
        "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\OLE\\Tracing",
        "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags",
        "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize",
        "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options",
        "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\ProfileList",
        "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Windows",
        "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion",
        "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\SideBySide",
        "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\MUI\\Settings",
        "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Display",
        "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\FileSystem\\",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\FipsAlgorithmPolicy",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\MUI\\Settings\\LanguageConfiguration",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\MUI\\UILanguages",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\MUI\\UILanguages\\PendingDelete",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\NLS\\Language",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\CustomLocale",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\ExtendedLocale",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\Sorting\\Versions",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SafeBoot\\Option",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\AppCertDlls",
        "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Srp\\GP\\DLL",
        "HKEY_LOCAL_MACHINE\\system\\CurrentControlSet\\control\\NetworkProvider\\HwOrder",
        "HKEY_LOCAL_MACHINE\\system\\CurrentControlSet\\control\\NetworkProvider\\ProviderOrder"
      ],
      "signature_matches": [
        {
          "id": "0",
          "format": "SIG_FORMAT_CAPA",
          "name": "print debug messages",
          "description": "host-interaction/log/debug/write-event",
          "authors": [
            "michael.hunhoff@mandiant.com"
          ],
          "match_data": [
            "api: OutputDebugString"
          ],
          "rule_src": "rule:\n  meta:\n    name: print debug messages\n    namespace: host-interaction/log/debug/write-event\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x401000\n  features:\n    - or:\n      - api: DbgPrint\n      - api: kernel32.OutputDebugString\n      - and:\n        - os: android\n        - api: __android_log_print\n"
        },
        {
          "id": "1",
          "format": "SIG_FORMAT_CAPA",
          "name": "move file",
          "description": "host-interaction/file-system/move",
          "authors": [
            "moritz.raabe@mandiant.com",
            "michael.hunhoff@mandiant.com"
          ],
          "match_data": [
            "api: MoveFile"
          ],
          "rule_src": "rule:\n  meta:\n    name: move file\n    namespace: host-interaction/file-system/move\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - File System::Move File [C0063]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - or:\n      - api: kernel32.MoveFile\n      - api: kernel32.MoveFileEx\n      - api: MoveFileWithProgress\n      - api: MoveFileTransacted\n      - api: rename\n      - api: _wrename\n      - api: System.IO.FileInfo::MoveTo\n      - api: System.IO.File::Move\n      - basic block:\n        - and:\n          - number: 1 = FO_MOVE\n          - or:\n            - api: kernel32.SHFileOperation\n      - call:\n        - and:\n          - number: 1 = FO_MOVE\n          - api: kernel32.SHFileOperation\n"
        },
        {
          "id": "2",
          "format": "SIG_FORMAT_CAPA",
          "name": "delete file",
          "description": "host-interaction/file-system/delete",
          "authors": [
            "moritz.raabe@mandiant.com",
            "michael.hunhoff@mandiant.com"
          ],
          "match_data": [
            "api: DeleteFile"
          ],
          "rule_src": "rule:\n  meta:\n    name: delete file\n    namespace: host-interaction/file-system/delete\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: span of calls\n    mbc:\n      - File System::Delete File [C0047]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x100015F0\n      # MoveFileEx\n      - 31600AD0D1A7EA615690DF111AE36C73:0x401A15\n      # NtDeleteFile\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001E04\n  features:\n    - or:\n      - api: kernel32.DeleteFile\n      - api: DeleteFileTransacted\n      - api: NtDeleteFile\n      - api: ZwDeleteFile\n      - api: remove\n      - api: _wremove\n      - api: System.IO.File::Delete\n      - api: System.IO.FileSystemInfo::Delete\n      # static\n      - basic block:\n        - and:\n          - number: 3 = FO_DELETE\n          - or:\n            - api: kernel32.SHFileOperation\n      - basic block:\n        - and:\n          - number: 4 = MOVEFILE_DELAY_UNTIL_REBOOT\n          - number: 0 = NULL\n          - api: MoveFileEx\n      # dynamic\n      - call:\n        - and:\n          - number: 3 = FO_DELETE\n          - or:\n            - api: kernel32.SHFileOperation\n      - call:\n        - and:\n          - number: 4 = MOVEFILE_DELAY_UNTIL_REBOOT\n          - number: 0 = NULL\n          - api: MoveFileEx\n"
        },
        {
          "id": "4",
          "format": "SIG_FORMAT_CAPA",
          "name": "get common file path",
          "description": "host-interaction/file-system",
          "authors": [
            "moritz.raabe@mandiant.com",
            "michael.hunhoff@mandiant.com",
            "anushka.virgaonkar@mandiant.com"
          ],
          "match_data": [
            "api: GetTempFileName",
            "api: GetTempPath"
          ],
          "rule_src": "rule:\n  meta:\n    name: get common file path\n    namespace: host-interaction/file-system\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003415\n      - 972B219F18379907A045431303F4DA7D:0x404887\n  features:\n    - or:\n      - api: kernel32.GetTempPath\n      - api: kernel32.GetTempFileName\n      - api: kernel32.GetSystemDirectory\n      - api: kernel32.GetWindowsDirectory\n      - api: kernel32.GetSystemWow64Directory\n      - api: GetAllUsersProfileDirectory\n      - api: GetAppContainerFolderPath\n      - api: GetCurrentDirectory\n      - api: GetDefaultUserProfileDirectory\n      - api: GetProfilesDirectory\n      - api: GetUserProfileDirectory\n      - api: SHGetFolderPathAndSubDir\n      - api: shell32.SHGetFolderPath\n      - api: shell32.SHGetFolderLocation\n      - api: shell32.SHGetKnownFolderPath\n      - api: shell32.SHGetSpecialFolderPath\n      - api: shell32.SHGetSpecialFolderLocation\n      - api: System.IO.Directory::GetCurrentDirectory\n      - api: System.Environment::GetFolderPath\n      - property/read: System.Environment::SystemDirectory\n      - property/read: System.Environment::CurrentDirectory\n"
        },
        {
          "id": "5",
          "format": "SIG_FORMAT_CAPA",
          "name": "get geographical location",
          "description": "collection",
          "authors": [
            "moritz.raabe",
            "michael.hunhoff@mandiant.com"
          ],
          "match_data": [
            "api: GetLocaleInfo"
          ],
          "rule_src": "# generated using capa explorer for IDA Pro\nrule:\n  meta:\n    name: get geographical location\n    namespace: collection\n    authors:\n      - moritz.raabe\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::System Location Discovery [T1614]\n    examples:\n      - 9879D201DC5ACA863F357184CD1F170E:0x10001A99\n  features:\n    - or:\n      - api: GetLocaleInfo\n      - api: GetLocaleInfoEx\n      - api: kernel32.GetUserGeoID\n      - api: kernel32.GetGeoInfo\n      # strings part of requests or parsed from response\n      # \"geo\" and \"zip\" are too short\n      # \"region\" results in FPs mostly related to memory\n      - string: /geolocation/i\n      - string: /geo-location/i\n      - string: /^city/i\n      - string: /region_code/i\n      - string: /region_name/i\n      - string: /^country/i\n      - string: /country_code/i\n      - string: /countrycode/i\n      - string: /country_name/i\n      - string: /continent_code/i\n      - string: /continent_name/i\n      - string: /^latitude/i\n      - string: /^longitude/i\n"
        },
        {
          "id": "6",
          "format": "SIG_FORMAT_CAPA",
          "name": "access PEB ldr_data",
          "description": "linking/runtime-linking",
          "authors": [
            "moritz.raabe@mandiant.com"
          ],
          "match_data": [
            "PEB access",
            "fs access"
          ],
          "rule_src": "rule:\n  meta:\n    name: access PEB ldr_data\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires offset features\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    references:\n      - https://www.geoffchappell.com/studies/windows/km/ntoskrnl/inc/api/ntpsapi_x/peb_ldr_data.htm\n      - https://github.com/d35ha/CallObfuscator/blob/5834aff9ff4511f1408ae4ce80b79737af4ae77b/ShellCode/shell_x64.asm#L8\n    examples:\n      - 3FDFB2D522E7DEECAAAF2F87420F7E75:0x4117B7\n  features:\n    - or:\n      - and:\n        - arch: i386\n        - description: x32\n\n        - match: PEB access\n\n        # x86 Windows uses fs:0 to access the TIB which contains SEH information at offset 0\n        # checking for fs:0 and a (possibly unrelated) number or offset often results in false positives\n\n        - offset: 0x0C = PEB.LDR_DATA\n\n        - or:\n          - description: resolve a module list\n          - offset: 0x0C = PEB.LDR_DATA.InLoadOrderModuleList\n          - offset: 0x14 = PEB.LDR_DATA.InMemoryOrderModuleList\n          - offset: 0x1C = PEB.LDR_DATA.InInitializationOrderModuleList\n\n      - and:\n        - arch: amd64\n        - description: x64\n\n        - match: PEB access\n\n        - offset: 0x18 = PEB.LDR_DATA\n\n        - or:\n          - description: resolve a module list\n          - offset: 0x10 = PEB.LDR_DATA.InLoadOrderModuleList\n          - offset: 0x20 = PEB.LDR_DATA.InMemoryOrderModuleList\n          - offset: 0x30 = PEB.LDR_DATA.InInitializationOrderModuleList\n",
          "refs": [
            {
              "ref": "https://www.geoffchappell.com/studies/windows/km/ntoskrnl/inc/api/ntpsapi_x/peb_ldr_data.htm"
            },
            {
              "ref": "https://github.com/d35ha/CallObfuscator/blob/5834aff9ff4511f1408ae4ce80b79737af4ae77b/ShellCode/shell_x64.asm#L8"
            }
          ]
        },
        {
          "id": "7",
          "format": "SIG_FORMAT_CAPA",
          "name": "write file on Windows",
          "description": "host-interaction/file-system/write",
          "authors": [
            "william.ballenthin@mandiant.com",
            "anushka.virgaonkar@mandiant.com"
          ],
          "match_data": [
            "api: WriteFile"
          ],
          "rule_src": "rule:\n  meta:\n    name: write file on Windows\n    namespace: host-interaction/file-system/write\n    authors:\n      - william.ballenthin@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - File System::Writes File [C0052]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - basic block:\n            - or:\n              - number: 0x40000000 = GENERIC_WRITE\n              - number: 0x2 = FILE_WRITE_DATA\n              - match: create or open file\n          - call:\n            - or:\n              - number: 0x40000000 = GENERIC_WRITE\n              - number: 0x2 = FILE_WRITE_DATA\n              - match: create or open file\n        - or:\n          - api: kernel32.WriteFile\n          - api: kernel32.WriteFileEx\n          - api: NtWriteFile\n          - api: ZwWriteFile\n          - api: _fwrite\n          - api: fwrite\n      - api: System.IO.File::WriteAllBytes\n      - api: System.IO.File::WriteAllBytesAsync\n      - api: System.IO.File::WriteAllLines\n      - api: System.IO.File::WriteAllLinesAsync\n      - api: System.IO.File::WriteAllText\n      - api: System.IO.File::WriteAllTextAsync\n      - api: System.IO.File::AppendAllLines\n      - api: System.IO.File::AppendAllLinesAsync\n      - api: System.IO.File::AppendAllText\n      - api: System.IO.File::AppendAllTextAsync\n      - api: System.IO.File::AppendText\n      - api: System.IO.FileInfo::AppendText\n"
        },
        {
          "id": "8",
          "format": "SIG_FORMAT_CAPA",
          "name": "get ntdll base address",
          "description": "linking/runtime-linking",
          "authors": [
            "moritz.raabe@mandiant.com"
          ],
          "match_data": [
            "PEB access",
            "access PEB ldr_data",
            "fs access"
          ],
          "rule_src": "rule:\n  meta:\n    name: get ntdll base address\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires offset features\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    references:\n      - https://idafchev.github.io/exploit/2017/09/26/writing_windows_shellcode.html\n      - https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/ldr_data_table_entry.htm\n    examples:\n      - 67f8302a2fd28d15f62d6d20d748bfe350334e5353cbdef112bd1f8231b5599d:0x40694A\n  features:\n    - and:\n      # PEB -> PEB.Ldr -> PEB_LDR_DATA.InLoadOrderModuleList.Flink\n      - match: access PEB ldr_data\n      # -> current module\n      - count(offset(0)): 1\n      # -> ntdll -> LDR_DATA_TABLE_ENTRY.DllBase\n      - or:\n        - and:\n          - arch: i386\n          - offset: 0x18 = LDR_DATA_TABLE_ENTRY.DllBase\n        - and:\n          - arch: amd64\n          - offset: 0x30 = LDR_DATA_TABLE_ENTRY.DllBase\n",
          "refs": [
            {
              "ref": "https://idafchev.github.io/exploit/2017/09/26/writing_windows_shellcode.html"
            },
            {
              "ref": "https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/ldr_data_table_entry.htm"
            }
          ]
        },
        {
          "id": "antidebug_setunhandledexceptionfilter",
          "name": "antidebug_setunhandledexceptionfilter",
          "description": "SetUnhandledExceptionFilter detected (possible anti-debug)",
          "match_data": [
            "Process rundll32.exe"
          ],
          "severity": "IMPACT_SEVERITY_INFO"
        },
        {
          "id": "language_check_registry",
          "name": "language_check_registry",
          "description": "Checks system language via registry key (possible geofencing)",
          "match_data": [
            "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\Nls\\CustomLocale\\en-US",
            "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\Nls\\ExtendedLocale\\en-US"
          ],
          "severity": "IMPACT_SEVERITY_INFO"
        }
      ],
      "registry_keys_set": [
        {
          "key": "HKLM\\Software\\Microsoft\\WBEM\\CIMOM\\ConfigValueEssNeedsLoading",
          "value": "1"
        },
        {
          "key": "HKLM\\Software\\Microsoft\\WBEM\\CIMOM\\List of event-active namespaces",
          "value": "00 00 54 00 45 00 76 00 65 00 6E 00 74 00 4C 00 6F 00 67 00 45 00 76 00 65 00 6E 00 74 00 43 00 6F 00 6E 00 73 00 75 00 6D 00 65 00 72 00"
        },
        {
          "key": "HKLM\\SYSTEM\\ControlSet001\\Control\\BackupRestore\\FilesNotToBackup\\BITS_LOG",
          "value": "%windir%\\System32\\Bits.log\n"
        },
        {
          "key": "HKLM\\SYSTEM\\ControlSet001\\Control\\BackupRestore\\FilesNotToBackup\\BITS_BAK",
          "value": "%windir%\\System32\\Bits.bak\n"
        },
        {
          "key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\BITS\\StateIndex",
          "value": "1"
        },
        {
          "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\%windir%\\system32\\advapi32.dll[MofResourceName]",
          "value": "LowDateTime:-1337772912,HighDateTime:30778796***Binary mof compiled successfully"
        },
        {
          "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\IDE\\DiskAMDX_HARDDISK___________________________2.5+____\\5&2770a7af&0&0.0.0_0-{05901221-D566-11d1-B2F0-00A0C9062910}",
          "value": "LowDateTime:803713417,HighDateTime:0***Binary mof compiled successfully"
        },
        {
          "key": "HKLM\\SYSTEM\\ControlSet001\\Services\\BITS\\Performance\\PerfMMFileName",
          "value": "Global\\MMF_BITS_s"
        },
        {
          "key": "HKLM\\SYSTEM\\ControlSet001\\Control\\TimeZoneInformation\\ActiveTimeBias",
          "value": "4294967176"
        }
      ],
      "attack_techniques": {
        "T1083": [
          {
            "severity": "INFO",
            "description": "get common file path",
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "4"
              }
            ]
          }
        ],
        "T1614": [
          {
            "severity": "INFO",
            "description": "get geographical location",
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "5"
              }
            ]
          }
        ],
        "T1129": [
          {
            "severity": "INFO",
            "description": "access PEB ldr_data",
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "6"
              }
            ]
          },
          {
            "severity": "INFO",
            "description": "get ntdll base address",
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "8"
              }
            ]
          }
        ],
        "T1055": [
          {
            "severity": "INFO",
            "description": "Creates a process in suspended mode (likely to inject code)"
          },
          {
            "severity": "INFO",
            "description": "Spawns processes"
          }
        ],
        "T1218.011": [
          {
            "severity": "INFO",
            "description": "Runs a DLL by calling functions"
          }
        ],
        "T1082": [
          {
            "severity": "INFO",
            "description": "Reads software policies"
          }
        ],
        "T1056": [
          {
            "severity": "INFO",
            "description": "Creates a DirectInput object (often for capturing keystrokes)"
          }
        ]
      }
    }
  }
}